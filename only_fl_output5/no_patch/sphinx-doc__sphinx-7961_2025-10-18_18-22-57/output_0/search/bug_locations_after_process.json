[
    {
        "rel_file_path": "sphinx/ext/mathjax.py",
        "abs_file_path": "/home/kimnal0/auto-code-rover/SWE-bench/testbed/sphinx-doc__sphinx/setup_sphinx-doc__sphinx__4.0/sphinx/ext/mathjax.py",
        "start": 70,
        "end": 88,
        "class_name": null,
        "method_name": "install_mathjax",
        "code": "70 def install_mathjax(app: Sphinx, env: BuildEnvironment) -> None:\n71     if app.builder.format != 'html' or app.builder.math_renderer_name != 'mathjax':  # type: ignore  # NOQA\n72         return\n73     if not app.config.mathjax_path:\n74         raise ExtensionError('mathjax_path config value must be set for the '\n75                              'mathjax extension to work')\n76 \n77     builder = cast(StandaloneHTMLBuilder, app.builder)\n78     domain = cast(MathDomain, env.get_domain('math'))\n79     if domain.has_equations():\n80         # Enable mathjax only if equations exists\n81         options = {'async': 'async'}\n82         if app.config.mathjax_options:\n83             options.update(app.config.mathjax_options)\n84         builder.add_js_file(app.config.mathjax_path, **options)\n85 \n86         if app.config.mathjax_config:\n87             body = \"MathJax.Hub.Config(%s)\" % json.dumps(app.config.mathjax_config)\n88             builder.add_js_file(None, type=\"text/x-mathjax-config\", body=body)\n",
        "intended_behavior": "This function is intended to add MathJax support to Sphinx-generated documentation. To resolve the issue, the code must be updated to facilitate the integration of MathJax 3.0, respecting the new initialization and configuration methods that MathJax 3.0 introduces. This involves replacing the use of `MathJax.Hub.Config` with the new configuration approaches suitable for MathJax 3.0. Furthermore, the method should ensure compatibility with MathJax 3.0's promise-based initialization system, and dynamically load the MathJax script with the properly updated paths and configuration options as per MathJax 3.0 documentation. The existing functionality, such as allowing users to customize MathJax configuration via Sphinx's `conf.py` and seamlessly rendering mathematical expressions in documents, must be preserved."
    }
]
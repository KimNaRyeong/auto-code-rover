[
    {
        "file": "django/db/backends/sqlite3/base.py",
        "class": "DatabaseWrapper",
        "method": "get_new_connection",
        "intended_behavior": "Within the `get_new_connection` method, after establishing the connection to the SQLite database, the method should execute a `PRAGMA user_version;` command to retrieve the SQLite version. Depending on the version, if it's lower than 3.25.0, the method should set a feature flag indicating that window functions are not supported. This could be managed by setting an attribute within the `DatabaseFeatures` class instance associated with the connection."
    },
    {
        "file": "django/db/backends/sqlite3/base.py",
        "class": "DatabaseFeatures",
        "method": "",
        "intended_behavior": "Add a new attribute e.g., `supports_window_functions` within the `DatabaseFeatures` class. This attribute should dynamically reflect whether the connected SQLite database supports window functions based on the SQLite version determined at connection time. This feature flag should be used throughout Django's ORM layer to conditionally allow or disallow window function usage, presenting a clear and informative error when such usage is attempted on unsupported versions."
    }
]
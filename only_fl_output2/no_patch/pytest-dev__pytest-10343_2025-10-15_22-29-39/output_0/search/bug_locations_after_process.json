[
    {
        "rel_file_path": "src/_pytest/deprecated.py",
        "abs_file_path": "/home/kimnal0/auto-code-rover/SWE-bench/testbed/pytest-dev__pytest/setup_pytest-dev__pytest__7.2/src/_pytest/deprecated.py",
        "start": 1,
        "end": 131,
        "class_name": null,
        "method_name": null,
        "code": "1 \"\"\"Deprecation messages and bits of code used elsewhere in the codebase that\n2 is planned to be removed in the next pytest release.\n3 \n4 Keeping it in a central location makes it easy to track what is deprecated and should\n5 be removed when the time comes.\n6 \n7 All constants defined in this module should be either instances of\n8 :class:`PytestWarning`, or :class:`UnformattedWarning`\n9 in case of warnings which need to format their messages.\n10 \"\"\"\n11 from warnings import warn\n12 \n13 from _pytest.warning_types import PytestDeprecationWarning\n14 from _pytest.warning_types import PytestRemovedIn8Warning\n15 from _pytest.warning_types import UnformattedWarning\n16 \n17 # set of plugins which have been integrated into the core; we use this list to ignore\n18 # them during registration to avoid conflicts\n19 DEPRECATED_EXTERNAL_PLUGINS = {\n20     \"pytest_catchlog\",\n21     \"pytest_capturelog\",\n22     \"pytest_faulthandler\",\n23 }\n24 \n25 \n26 # This can be* removed pytest 8, but it's harmless and common, so no rush to remove.\n27 # * If you're in the future: \"could have been\".\n28 YIELD_FIXTURE = PytestDeprecationWarning(\n29     \"@pytest.yield_fixture is deprecated.\\n\"\n30     \"Use @pytest.fixture instead; they are the same.\"\n31 )\n32 \n33 WARNING_CMDLINE_PREPARSE_HOOK = PytestRemovedIn8Warning(\n34     \"The pytest_cmdline_preparse hook is deprecated and will be removed in a future release. \\n\"\n35     \"Please use pytest_load_initial_conftests hook instead.\"\n36 )\n37 \n38 FSCOLLECTOR_GETHOOKPROXY_ISINITPATH = PytestRemovedIn8Warning(\n39     \"The gethookproxy() and isinitpath() methods of FSCollector and Package are deprecated; \"\n40     \"use self.session.gethookproxy() and self.session.isinitpath() instead. \"\n41 )\n42 \n43 STRICT_OPTION = PytestRemovedIn8Warning(\n44     \"The --strict option is deprecated, use --strict-markers instead.\"\n45 )\n46 \n47 # This deprecation is never really meant to be removed.\n48 PRIVATE = PytestDeprecationWarning(\"A private pytest class or function was used.\")\n49 \n50 ARGUMENT_PERCENT_DEFAULT = PytestRemovedIn8Warning(\n51     'pytest now uses argparse. \"%default\" should be changed to \"%(default)s\"',\n52 )\n53 \n54 ARGUMENT_TYPE_STR_CHOICE = UnformattedWarning(\n55     PytestRemovedIn8Warning,\n56     \"`type` argument to addoption() is the string {typ!r}.\"\n57     \" For choices this is optional and can be omitted, \"\n58     \" but when supplied should be a type (for example `str` or `int`).\"\n59     \" (options: {names})\",\n60 )\n61 \n62 ARGUMENT_TYPE_STR = UnformattedWarning(\n63     PytestRemovedIn8Warning,\n64     \"`type` argument to addoption() is the string {typ!r}, \"\n65     \" but when supplied should be a type (for example `str` or `int`).\"\n66     \" (options: {names})\",\n67 )\n68 \n69 \n70 HOOK_LEGACY_PATH_ARG = UnformattedWarning(\n71     PytestRemovedIn8Warning,\n72     \"The ({pylib_path_arg}: py.path.local) argument is deprecated, please use ({pathlib_path_arg}: pathlib.Path)\\n\"\n73     \"see https://docs.pytest.org/en/latest/deprecations.html\"\n74     \"#py-path-local-arguments-for-hooks-replaced-with-pathlib-path\",\n75 )\n76 \n77 NODE_CTOR_FSPATH_ARG = UnformattedWarning(\n78     PytestRemovedIn8Warning,\n79     \"The (fspath: py.path.local) argument to {node_type_name} is deprecated. \"\n80     \"Please use the (path: pathlib.Path) argument instead.\\n\"\n81     \"See https://docs.pytest.org/en/latest/deprecations.html\"\n82     \"#fspath-argument-for-node-constructors-replaced-with-pathlib-path\",\n83 )\n84 \n85 WARNS_NONE_ARG = PytestRemovedIn8Warning(\n86     \"Passing None has been deprecated.\\n\"\n87     \"See https://docs.pytest.org/en/latest/how-to/capture-warnings.html\"\n88     \"#additional-use-cases-of-warnings-in-tests\"\n89     \" for alternatives in common use cases.\"\n90 )\n91 \n92 KEYWORD_MSG_ARG = UnformattedWarning(\n93     PytestRemovedIn8Warning,\n94     \"pytest.{func}(msg=...) is now deprecated, use pytest.{func}(reason=...) instead\",\n95 )\n96 \n97 INSTANCE_COLLECTOR = PytestRemovedIn8Warning(\n98     \"The pytest.Instance collector type is deprecated and is no longer used. \"\n99     \"See https://docs.pytest.org/en/latest/deprecations.html#the-pytest-instance-collector\",\n100 )\n101 HOOK_LEGACY_MARKING = UnformattedWarning(\n102     PytestDeprecationWarning,\n103     \"The hook{type} {fullname} uses old-style configuration options (marks or attributes).\\n\"\n104     \"Please use the pytest.hook{type}({hook_opts}) decorator instead\\n\"\n105     \" to configure the hooks.\\n\"\n106     \" See https://docs.pytest.org/en/latest/deprecations.html\"\n107     \"#configuring-hook-specs-impls-using-markers\",\n108 )\n109 \n110 # You want to make some `__init__` or function \"private\".\n111 #\n112 #   def my_private_function(some, args):\n113 #       ...\n114 #\n115 # Do this:\n116 #\n117 #   def my_private_function(some, args, *, _ispytest: bool = False):\n118 #       check_ispytest(_ispytest)\n119 #       ...\n120 #\n121 # Change all internal/allowed calls to\n122 #\n123 #   my_private_function(some, args, _ispytest=True)\n124 #\n125 # All other calls will get the default _ispytest=False and trigger\n126 # the warning (possibly error in the future).\n127 \n128 \n129 def check_ispytest(ispytest: bool) -> None:\n130     if not ispytest:\n131         warn(PRIVATE, stacklevel=3)\n",
        "intended_behavior": "Modify the mechanism that generates `HOOK_LEGACY_MARKING` warning messages to include the source location (file path and, if feasible, the plugin name) where the deprecated hook implementation is located. This involves enhancing the warning generation logic to dynamically capture and append the location metadata to the warning message. The existing functionality of warning generation should be preserved, with the addition of helping developers pinpoint the location of deprecated usage more efficiently."
    }
]
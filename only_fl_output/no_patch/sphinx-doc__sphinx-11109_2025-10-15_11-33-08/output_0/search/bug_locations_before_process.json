[
    {
        "file": "sphinx/domains/python.py",
        "class": "",
        "method": "_parse_annotation",
        "intended_behavior": "The `_parse_annotation` method needs to be enhanced to incorporate cleaner formatting for `Union`, `Optional`, `Literal`, and constants in line with PEP 604 and the specific improvements requested in the issue. These enhancements include:\n\n- For `Union` type annotations, directly handle AST nodes representing the union (e.g., `ast.BinOp` nodes with `ast.BitOr` operators) to output `X | Y` instead of `Union[X, Y]`.\n- For `Optional` type annotations, detect patterns matching `Optional[X]` and transform them into `X | None`.\n- For `Literal` type annotations, simplify the display of literals by removing the \"Literal\" preamble and displaying the values directly, applying normal Python syntax highlighting to these literals to differentiate them clearly in the documentation.\n- Maintain the existing functionality for all other types of annotations not specifically mentioned in the issue, ensuring that the solution is backward compatible and does not negatively impact the formatting of other types of annotations.\n- Implement these changes behind a configuration option, allowing Sphinx users to opt-in to this new style of type annotation display. This would likely involve adding a new configuration parameter and modifying the Sphinx build environment to conditionally apply these formatting rules based on the user's configuration.\n\nThe modifications should focus on extending or adapting the inner functions within `_parse_annotation`, such as the `unparse` function and possibly introducing a new helper function (like the existing `_unparse_pep_604_annotation`) to encapsulate the logic for handling `Union` and `Optional` in the PEP 604 style, ensuring the code remains readable and maintainable.\n\nAdditionally, attention should be given to correctly integrating these changes with the rest of the Sphinx build process, particularly in how type annotations are processed and displayed in the generated documentation, to ensure a seamless user experience and no disruption to existing documentation projects not opting into this new formatting."
    }
]